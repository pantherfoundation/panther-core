import * as path from 'path';
import {toBeHex} from 'ethers';
import {wtns} from 'snarkjs';
import {poseidon, eddsa, babyjub} from 'circomlibjs';
import {MerkleTree} from '@zk-kit/merkle-tree';

import circom_wasm_tester from 'circom_tester';
const wasm_tester = circom_wasm_tester.wasm;

import {getOptions} from './helpers/circomTester';
import {
    deriveChildPubKeyFromRootPubKey,
    deriveChildPrivKeyFromRootPrivKey,
} from '@panther-core/crypto/lib/base/keypairs';
import {bigIntToUint8Array, uint8ArrayToBigInt} from './helpers/utils';

describe('Main z-transaction - Non ZeroInput - With ZZoneSealing - Witness computation', async function (this: any) {
    let circuit: any;
    let mainTxWasm: any;
    let mainTxWitness: any;

    this.timeout(10_000_000);

    before(async () => {
        const opts = getOptions();
        const input = path.join(
            opts.basedir,
            './circuits/mainZTransactionV1.circom',
        );
        circuit = await wasm_tester(input, opts);

        mainTxWasm = path.join(
            opts.basedir,
            './compiled/zTransaction/circuits.wasm',
        );
        mainTxWitness = path.join(
            opts.basedir,
            './compiled/generate_witness.js',
        );
    });

    /* 
        Deposit Transaction
        . External deposit amount - Positive
        . Internal UTXO's created - 1 Valid UTXO, 1 empty UTXO
        . External withdraw amount - 0
        . zZoneSealing - 1
    */

    /* 1. START ===== utxoOutCommitment computation  ===== */
    // random generated by the current ZAccount (Sender)
    const utxoOutSpendPubKeyRandom =
        94610875299416841087047638331595192377823041951625049650587645487287023247n;

    const rootPublicKeys = [
        9665449196631685092819410614052131494364846416353502155560380686439149087040n,
        13931233598534410991314026888239110837992015348186918500560502831191846288865n,
    ];

    // Deriving spendPublicKeys
    const spendPublicKeys = deriveChildPubKeyFromRootPubKey(
        [rootPublicKeys[0], rootPublicKeys[1]],
        utxoOutSpendPubKeyRandom,
    );
    // spendPublicKeys=> [
    //     14246403999710938406511708005371869365761764005935515093254179451459674970849n,
    //     21326673881528717285846441993323054804029809143339909697348054283661068579914n
    //   ]
    // console.log('spendPublicKeys=>', spendPublicKeys);

    const random_hash = poseidon([utxoOutSpendPubKeyRandom]);
    const hiden_hash = poseidon([
        14246403999710938406511708005371869365761764005935515093254179451459674970849n, // spendPublicKeys[0]
        21326673881528717285846441993323054804029809143339909697348054283661068579914n, // spendPublicKeys[1]
        random_hash,
        0, // utxoZAsset
        33, // zAccountUtxoInId
        2, // utxoOutOriginNetworkId
        2, // utxoOutTargetNetworkId,
        1700020032, // utxoOutCreateTime - Wednesday, 15 November 2023 03:47:12
        1, // zAccountUtxoInZoneId
        1, // utxoOutTargetZoneId
        6461944716578528228684977568060282675957977975225218900939908264185798821478n,
        6315516704806822012759516718356378665240592543978605015143731597167737293922n,
    ]);
    // hiden_hash=> 20944281038676863025885298568647471383006757154835642028074406376636180170719n
    // console.log('hiden_hash=>', hiden_hash);

    const utxoOutCommitment = poseidon([10, hiden_hash]); // 10 - utxoOutAmount
    // utxoOutCommitment=> 19665494296958373769078652731465008366346638314720836754762203726116490587574n
    // console.log('utxoOutCommitment=>', utxoOutCommitment);
    /* 1. END ===== utxoOutCommitment computation  ===== */

    /* 2. START ===== zAccountUtxoInSpendPrivKey computation  ===== */
    // Derive child spending private key from root spending private key
    const zAccountRootSpendPrivKey =
        1364957401031907147846036885962614753763820022581024524807608342937054566107n;
    const zAccountUtxoOutSpendKeyRandomFromAMMExchange =
        2330947425277212370453817539463162824729034812206690133672917694841149229695n;

    const deriveChildPrivKey = deriveChildPrivKeyFromRootPrivKey(
        zAccountRootSpendPrivKey,
        zAccountUtxoOutSpendKeyRandomFromAMMExchange,
    );
    // 862427069656991966059708194449869313346312152472849770815560202542548015678n
    // console.log('deriveChildPrivKey=>', deriveChildPrivKey);
    /* 2. END ===== zAccountUtxoInSpendPrivKey computation  ===== */

    /* 3. START ===== zAccountUtxoInNullifier computation  ===== */
    const zAccountUtxoInNullifierPrivKey =
        2081961849142627796057765042284889488177156119328724687723132407819597118232n;
    const zAccountUtxoOutCommitmentFromAMMExchange =
        18175105476890322584485034559689089475598097526056309132759314620620028004517n;
    const zAccountUtxoInNullifierHasher = poseidon([
        zAccountUtxoInNullifierPrivKey,
        zAccountUtxoOutCommitmentFromAMMExchange,
    ]);

    // 14856074355986772022219701173319041991936633370561779650945404741033792353318n
    // console.log(
    //     'zAccountUtxoInNullifierHasher=>',
    //     zAccountUtxoInNullifierHasher,
    // );
    /* 3. END ===== zAccountUtxoInNullifier computation  ===== */

    /* 4. START ===== zAccountUtxoOutCommitment commitment  ===== */
    // const random = moduloBabyJubSubFieldPrime(
    //     generateRandom256Bits(),
    // );
    const zAccountUtxoOutSpendKeyRandom =
        1215795509656177802870041674430711702496004716229829094660171184836034819583n;

    const zAccountUtxoOutPubKeyDeriver = deriveChildPubKeyFromRootPubKey(
        [rootPublicKeys[0], rootPublicKeys[1]],
        zAccountUtxoOutSpendKeyRandom,
    );
    // zAccountUtxoOutPubKeyDeriver=> [
    //     8546145906299248534728498285928494228934900865357138634779883655094892658767n,
    //     16233949703698560494882186452344248221629460060630482295539300625168232480225n
    //   ]
    // console.log('zAccountUtxoOutPubKeyDeriver=>', zAccountUtxoOutPubKeyDeriver);

    const hash1 = poseidon([
        8546145906299248534728498285928494228934900865357138634779883655094892658767n, // zAccountUtxoOutPubKeyDeriver[0]
        16233949703698560494882186452344248221629460060630482295539300625168232480225n, // zAccountUtxoOutPubKeyDeriver[1]
        9665449196631685092819410614052131494364846416353502155560380686439149087040n, // rootPublicKeys[0]
        13931233598534410991314026888239110837992015348186918500560502831191846288865n, // rootPublicKeys[1]
        1187405049038689339917658225106283881019816002721396510889166170461283567874n, // zAccountUtxoInReadPubKey[0]
        311986042833546580202940940143769849297540181368261575540657864271112079432n, // zAccountUtxoInReadPubKey[1]
        18636161575160505712724711689946435964943204943778681265331835661113836693938n, // zAccountUtxoInNullifierPubKey[0]
        21369418187085352831313188453068285816400064790476280656092869887652115165947n, // zAccountUtxoInNullifierPubKey[1]
    ]);

    const zAccountUtxoOutCommitment = poseidon([
        hash1,
        407487970930055136132864974074225519407787604125n, // zAccountUtxoInMasterEOA
        33, // zAccountUtxoInId
        9999989100, // zAccountUtxoOutZkpAmount
        0, // zAccountUtxoInPrpAmount + rewards.amountPrp
        1, // utxoOutTargetZoneId
        1702652400, // zAccountUtxoInExpiryTime
        3, // zAccountUtxoInNonce + 1
        20200, // zAccountUtxoInTotalAmountPerTimePeriod
        1700020032, // utxoOutCreateTime - same time as zAssetUTXO got created
        2,
    ]);
    // 252201640316781803990098408451884564126495501953986423034221778417602805405n
    // console.log('zAccountUtxoOutCommitment=>', zAccountUtxoOutCommitment);
    /* 4. END ===== zAccountUtxoOutCommitment commitment  ===== */

    /* 5. START ===== State of UTXO tree ===== */
    // During the deposit phase 4 utxo's should exists in the tree.
    // 1. zAccount registration's ZAccountUTXO
    // 2. AMM voucher exchanges's ZAccountUTXO
    // 3. AMM Exchanges's ZAccountUTXO
    // 4. AMM Exchanges's ZAssetUTXO

    const busMerkleTree = new MerkleTree(
        poseidon,
        26,
        BigInt(
            2896678800030780677881716886212119387589061708732637213728415628433288554509n,
        ),
    );
    // 12604557588521919493356492354767978894799472715473645550898984861352936983014n
    // console.log('busUTXOMerkleTree root=>', busMerkleTree.root);

    const ZAccountRegistrationZAccOutUTXO =
        9775219500384962933792568081585395848317570806746644855790488573783186458332n; // ZAccount UTXO created during registration
    const ammVoucherExchangeZAccOutUTXO =
        9801583813274409579839703000557872896423943281169404264890046333778640256067n; // ZAccount UTXO created during AMM Voucher Exchange
    const ammExchangeZAccOutUTXO =
        18175105476890322584485034559689089475598097526056309132759314620620028004517n; // ZAccount UTXO created during AMM Exchange
    const ammExchangeZAssetOutUTXO =
        9848159934633945213815166899374997597482648646636678651521985478275117087002n; // ZAsset UTXO created during AMM Exchange

    busMerkleTree.insert(ZAccountRegistrationZAccOutUTXO); // 0
    busMerkleTree.insert(ammVoucherExchangeZAccOutUTXO); // 1
    busMerkleTree.insert(ammExchangeZAccOutUTXO); // 2
    busMerkleTree.insert(ammExchangeZAssetOutUTXO); // 3
    // console.log(busMerkleTree.createProof(3));
    // console.log(busMerkleTree.createProof(2));
    /* 5. END ===== State of UTXO tree ===== */

    /* 7. START ===== dataEscrowEphimeralRandom + dataEscrowEphemeralPubKeyAx + dataEscrowEphemeralPubKeyAy  ===== */
    const dataEscrowEphimeralRandom =
        2508770261742365048726528579942226801565607871885423400214068953869627805520n;
    // [
    //     4301916310975298895721162797900971043392040643140207582177965168853046592976n,
    //     815388028464849479935447593762613752978886104243152067307597626016673798528n,
    // ];
    // dataEscrowEphimeralPubKeyAx and dataEscrowEphimeralPubKeyAy extraction using BabyPbk
    // console.log(
    //     babyjub.mulPointEscalar(babyjub.Base8, dataEscrowEphimeralRandom),
    // );
    /* 7. END ===== dataEscrowEphimeralRandom + dataEscrowEphemeralPubKeyAx + dataEscrowEphemeralPubKeyAy  ===== */

    /* 8. START ===== daoDataEscrowEphimeralRandom + daoDataEscrowEphemeralPubKeyAx + daoDataEscrowEphemeralPubKeyAy ===== */
    const daoDataEscrowEphimeralRandom =
        2486295975768183987242341265649589729082265459252889119245150374183802141273n;
    // [
    //     18172727478723733672122242648004425580927771110712257632781054272274332874233n,
    //     18696859439217809465524370245449396885627295546811556940609392448191776076084n
    //   ]
    // daoDataEscrowEphemeralPubKeyAx and daoDataEscrowEphemeralPubKeyAy extraction using BabyPbk
    // console.log(
    //     babyjub.mulPointEscalar(babyjub.Base8, daoDataEscrowEphimeralRandom),
    // );
    /* 8. END ===== daoDataEscrowEphimeralRandom + daoDataEscrowEphemeralPubKeyAx + daoDataEscrowEphemeralPubKeyAy ===== */

    /* 9. START ===== kytSignature computation ===== */
    const kytInternalHash = poseidon([
        407487970930055136132864974074225519407787604125n, // kytSignedMessageSigner
        0n, // kytSignedMessageChargedAmountZkp
        poseidon([
            1215795509656177802870041674430711702496004716229829094660171184836034819583n, // zAccountUtxoOutSpendKeyRandom
        ]),
        0, // kytSignedMessageSession
    ]);
    // 7971180363495038711635172034442113396859363503742890497288334338069717985253
    // console.log('kytInternalHash=>', kytInternalHash);

    const kytSignedMessageHashInternal = poseidon([
        253, // kytSignedMessagePackageType
        1735689600, // kytSignedMessageTimestamp
        7971180363495038711635172034442113396859363503742890497288334338069717985253n, // kytInternalHash
        10423494343006799813370996707236493762718882344186851738760354027050895770547n, // kytDepositSignedMessageReceiver
        0, // kytSignedWithdrawSignedMessageHash
        0, // kytSignedMessageDataEscrowHash
    ]);
    // 6099429931396121996657066805913447529635090159324513955306339471985599147963n
    // console.log('kytSignedMessageHashInternal=>', kytSignedMessageHashInternal);

    // assumed private key - purefi
    const prvKey = Buffer.from(
        '0001020304050607080900010203040506070809000102030405060708090001',
        'hex',
    );

    const pubKey = eddsa.prv2pub(prvKey);
    // 13277427435165878497778222415993513565335242147425444199013288855685581939618n
    const kycEdDsaPubKey0 = pubKey[0];

    // 13622229784656158136036771217484571176836296686641868549125388198837476602820n
    const kycEdDsaPubKey1 = pubKey[1];

    const signature = eddsa.signPoseidon(prvKey, kytSignedMessageHashInternal);
    // signature=> {
    //     R8: [
    //       7248046211883189204026564017222357952032425034486643207391252095407290468285n,
    //       8732982225844251514845234508320910044066797888045792804410516501305721796165n
    //     ],
    //     S: 2305533273584353825739435722420744759947022991637956155259409042540895942602n
    //   }
    // console.log('signature=>', signature);

    /* 9. END ===== kytSignature computation ===== ===== */

    const nonZeroInput = {
        extraInputsHash: 0,

        token: 365481738974395054943628650313028055219811856521n,
        tokenId: 0,
        zAssetId: 0,
        zAssetToken: 365481738974395054943628650313028055219811856521n,
        zAssetTokenId: 0,
        zAssetOffset: 0,

        depositAmount: 10 ** 13, // deposit(Unscaled) amount is non zero for deposit-only-tx
        withdrawAmount: 0, // withdraw amount and withdraw change is 0 for deposit-only-tx
        utxoZAsset: 0,

        zAssetIdZkp: 0,

        utxoInAmount: [0, 0], // will be 0 for deposit-only-tx
        utxoOutAmount: [10, 0], // 1 valid utxo got created as part of deposit-only-tx

        chargedAmountZkp: 10 ** 15, // For better testing choosing chargedAmountZkp and addedAmountZkp >= 10 ** 12
        addedAmountZkp: 10 ** 14,
        zAccountUtxoInZkpAmount: 9999990000,
        zAccountUtxoOutZkpAmount: 9999989100,
        zAssetWeight: 20n,
        zAssetScale: 10 ** 12,
        zAssetScaleZkp: 10 ** 12,

        // zAsset
        zAssetNetwork: 2n,
        zAssetMerkleRoot:
            3907962152156750334193496040045314188759069762668001420985753241607405656087n,
        zAssetPathIndices: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        zAssetPathElements: [
            2896678800030780677881716886212119387589061708732637213728415628433288554509n,
            15915358021544645824948763611506574620607002248967455613245207713011512736724n,
            3378776220260879286502089033253596247983977280165117209776494090180287943112n,
            13332607562825133358947880930907706925768730553195841232963500270946125500492n,
            2602133270707827583410190225239044634523625207877234879733211246465561970688n,
            19603150025355661252212198237607440386334054455687766589389473805115541553727n,
            21078238521337523625806977154031988767929399923323679789427062985634312723305n,
            15530836891415741166399860451702547522959094984965127719828675838122418186767n,
            17831836427614557290431652044145414371925087626131808598362009890774438652119n,
            4465836784202878977538296341471470300441964855135851519008900812038788261656n,
            12878033372712703816810492505815415858124057351499708737135229819203122809944n,
            18307780612008914306024415546812737365063691384665843671053755584619447524447n,
            18399220794236723308907532455368503933105202479015828179801520916772962880998n,
            17997772780903759195601581429183819619412163062353143936165307874482723961709n,
            18496693394049906980893311686550786982256672525298758106045562727433199943509n,
            12455859713696229724526221339047857485467607588813434501517928769317308134556n,
        ],

        zNetworkId: 2,

        zAssetTokenZkp: 365481738974395054943628650313028055219811856521n,
        zAssetTokenIdZkp: 0,
        zAssetNetworkZkp: 2,
        zAssetOffsetZkp: 0,
        zAssetWeightZkp: 20,
        zAssetPathIndicesZkp: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        zAssetPathElementsZkp: [
            2896678800030780677881716886212119387589061708732637213728415628433288554509n,
            15915358021544645824948763611506574620607002248967455613245207713011512736724n,
            3378776220260879286502089033253596247983977280165117209776494090180287943112n,
            13332607562825133358947880930907706925768730553195841232963500270946125500492n,
            2602133270707827583410190225239044634523625207877234879733211246465561970688n,
            19603150025355661252212198237607440386334054455687766589389473805115541553727n,
            21078238521337523625806977154031988767929399923323679789427062985634312723305n,
            15530836891415741166399860451702547522959094984965127719828675838122418186767n,
            17831836427614557290431652044145414371925087626131808598362009890774438652119n,
            4465836784202878977538296341471470300441964855135851519008900812038788261656n,
            12878033372712703816810492505815415858124057351499708737135229819203122809944n,
            18307780612008914306024415546812737365063691384665843671053755584619447524447n,
            18399220794236723308907532455368503933105202479015828179801520916772962880998n,
            17997772780903759195601581429183819619412163062353143936165307874482723961709n,
            18496693394049906980893311686550786982256672525298758106045562727433199943509n,
            12455859713696229724526221339047857485467607588813434501517928769317308134556n,
        ],

        forTxReward: 10,
        forUtxoReward: 1828,
        forDepositReward: 57646075,

        spendTime: 0n, // now time, but can be 0 as it is taken care off in rewardsExtended

        // These are 0 for deposit only tx
        // 1) utxoInAmount = 0
        // 2) utxoInSpendPrivKey = 0
        // 3) utxoInSpendKeyRandom = 0

        utxoInSpendPrivKey: [0, 0],
        utxoInSpendKeyRandom: [0, 0],

        // Since the input UTXO is null, other info regarding the input UTXO will be null
        utxoInOriginZoneId: [0, 0],
        utxoInOriginZoneIdOffset: [0, 0],
        utxoInOriginNetworkId: [0, 0], // Since there is no UTXO, should it be 0?
        utxoInTargetNetworkId: [0, 0],
        utxoInCreateTime: [0, 0],
        utxoInZAccountId: [0, 0], // Whether it is 0 or an actual ZAccountID that should not matter as the check will not pass.
        utxoInMerkleTreeSelector: [
            [0, 0],
            [0, 0],
        ],
        utxoInPathIndices: [
            [
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            ],
            [
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            ],
        ],
        utxoInPathElements: [
            [
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            ],
            [
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            ],
        ],
        utxoInNullifier: [0, 0],
        utxoInDataEscrowPubKey: [
            [0, 1],
            [0, 1],
        ],

        // input 'zAccount UTXO'
        zAccountUtxoInId: 33,
        zAccountUtxoInPrpAmount: 0,
        zAccountUtxoInZoneId: 1,
        zAccountUtxoInNetworkId: 2,
        zAccountUtxoInExpiryTime: 1702652400,
        zAccountUtxoInNonce: 2,
        zAccountUtxoInTotalAmountPerTimePeriod: 0,
        zAccountUtxoInCreateTime: 1695282515, // creation time of ZAccount
        zAccountUtxoInRootSpendPubKey: [
            9665449196631685092819410614052131494364846416353502155560380686439149087040n,
            13931233598534410991314026888239110837992015348186918500560502831191846288865n,
        ],
        zAccountUtxoInReadPubKey: [
            1187405049038689339917658225106283881019816002721396510889166170461283567874n,
            311986042833546580202940940143769849297540181368261575540657864271112079432n,
        ],
        zAccountUtxoInNullifierPubKey: [
            18636161575160505712724711689946435964943204943778681265331835661113836693938n,
            21369418187085352831313188453068285816400064790476280656092869887652115165947n,
        ],
        zAccountUtxoInMasterEOA:
            407487970930055136132864974074225519407787604125n,
        zAccountUtxoInSpendPrivKey:
            862427069656991966059708194449869313346312152472849770815560202542548015678n,

        zAccountUtxoInReadPrivKey:
            1807143148206188134925427242927492302158087995127931582887251149414169118083n,

        zAccountUtxoInNullifierPrivKey:
            2081961849142627796057765042284889488177156119328724687723132407819597118232n,

        zAccountUtxoInMerkleTreeSelector: [1, 0],
        zAccountUtxoInPathIndices: [
            0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
        zAccountUtxoInPathElements: [
            9848159934633945213815166899374997597482648646636678651521985478275117087002n,
            9728728322509746395652389243978665656438734693550117139438068940776719151145n,
            3378776220260879286502089033253596247983977280165117209776494090180287943112n,
            13332607562825133358947880930907706925768730553195841232963500270946125500492n,
            2602133270707827583410190225239044634523625207877234879733211246465561970688n,
            19603150025355661252212198237607440386334054455687766589389473805115541553727n,
            21078238521337523625806977154031988767929399923323679789427062985634312723305n,
            15530836891415741166399860451702547522959094984965127719828675838122418186767n,
            17831836427614557290431652044145414371925087626131808598362009890774438652119n,
            4465836784202878977538296341471470300441964855135851519008900812038788261656n,
            12878033372712703816810492505815415858124057351499708737135229819203122809944n,
            18307780612008914306024415546812737365063691384665843671053755584619447524447n,
            18399220794236723308907532455368503933105202479015828179801520916772962880998n,
            17997772780903759195601581429183819619412163062353143936165307874482723961709n,
            18496693394049906980893311686550786982256672525298758106045562727433199943509n,
            12455859713696229724526221339047857485467607588813434501517928769317308134556n,
            4689866144310700684516443679096813921756239671572972966393880542662538400201n,
            15369835007378492529084633432655739856631861107309342928676871259240227049033n,
            11345121393552856548579926390199540849469635305183604045111689968777651956473n,
            11299066061427200562963422042645343948885353762628147353062799587547441871332n,
            13642291777448032365864888577168560039775015251774208221818005338405304930884n,
            5990068516814370380711726420154273589568095823652643357428323105329308577610n,
            3326440148296065541386325860294367616471601340115249960006624245213734239367n,
            17613623862311960463347469460117166104477522402420094872382418386742059442736n,
            16619835833299406266546819907603615045049052832835825671901337303713338780409n,
            15002435000641955406214223423745696701460524528446564760654584364314696565951n,
            0,
            0,
            0,
            0,
            0,
            0,
        ],
        zAccountUtxoInNullifier:
            14856074355986772022219701173319041991936633370561779650945404741033792353318n,

        zAccountBlackListLeaf: 0,
        zAccountBlackListMerkleRoot:
            19217088683336594659449020493828377907203207941212636669271704950158751593251n,

        zAccountBlackListPathElements: [
            0,
            14744269619966411208579211824598458697587494354926760081771325075741142829156n,
            7423237065226347324353380772367382631490014989348495481811164164159255474657n,
            11286972368698509976183087595462810875513684078608517520839298933882497716792n,
            3607627140608796879659380071776844901612302623152076817094415224584923813162n,
            19712377064642672829441595136074946683621277828620209496774504837737984048981n,
            20775607673010627194014556968476266066927294572720319469184847051418138353016n,
            3396914609616007258851405644437304192397291162432396347162513310381425243293n,
            21551820661461729022865262380882070649935529853313286572328683688269863701601n,
            6573136701248752079028194407151022595060682063033565181951145966236778420039n,
            12413880268183407374852357075976609371175688755676981206018884971008854919922n,
            14271763308400718165336499097156975241954733520325982997864342600795471836726n,
            20066985985293572387227381049700832219069292839614107140851619262827735677018n,
            9394776414966240069580838672673694685292165040808226440647796406499139370960n,
            11331146992410411304059858900317123658895005918277453009197229807340014528524n,
            15819538789928229930262697811477882737253464456578333862691129291651619515538n,
        ],

        zZoneOriginZoneIDs: 1,
        zZoneTargetZoneIDs: 1,
        zZoneNetworkIDsBitMap: 5,
        zZoneTrustProvidersMerkleTreeLeafIDsAndRulesList: 1577058395,
        zZoneKycExpiryTime: 10368000,
        zZoneKytExpiryTime: 86400,
        zZoneDepositMaxAmount: 1 * 10 ** 12,
        zZoneWithdrawMaxAmount: 1 * 10 ** 12,
        zZoneInternalMaxAmount: 1 * 10 ** 12,
        zZoneMerkleRoot:
            14189511324259672403799169204478898082389936563693111126414306380356116434465n,

        zZonePathElements: [
            2896678800030780677881716886212119387589061708732637213728415628433288554509n,
            15915358021544645824948763611506574620607002248967455613245207713011512736724n,
            3378776220260879286502089033253596247983977280165117209776494090180287943112n,
            13332607562825133358947880930907706925768730553195841232963500270946125500492n,
            2602133270707827583410190225239044634523625207877234879733211246465561970688n,
            19603150025355661252212198237607440386334054455687766589389473805115541553727n,
            21078238521337523625806977154031988767929399923323679789427062985634312723305n,
            15530836891415741166399860451702547522959094984965127719828675838122418186767n,
            17831836427614557290431652044145414371925087626131808598362009890774438652119n,
            4465836784202878977538296341471470300441964855135851519008900812038788261656n,
            12878033372712703816810492505815415858124057351499708737135229819203122809944n,
            18307780612008914306024415546812737365063691384665843671053755584619447524447n,
            18399220794236723308907532455368503933105202479015828179801520916772962880998n,
            17997772780903759195601581429183819619412163062353143936165307874482723961709n,
            18496693394049906980893311686550786982256672525298758106045562727433199943509n,
            12455859713696229724526221339047857485467607588813434501517928769317308134556n,
        ],
        zZonePathIndices: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        zZoneEdDsaPubKey: [
            13969057660566717294144404716327056489877917779406382026042873403164748884885n,
            11069452135192839850369824221357904553346382352990372044246668947825855305207n,
        ],

        zZoneDataEscrowEphemeralRandom:
            790122152066676684676093302872898287841903882354339429497975929636832086290n,

        zZoneDataEscrowEphemeralPubKeyAx:
            8203289148254703516772267706874329469330087297928457772489392227653451244213n,

        zZoneDataEscrowEphemeralPubKeyAy:
            19998992060707539017877331634603765261877243592349009808298088607668947098216n,

        zZoneZAccountIDsBlackList:
            1766847064778384329583297500742918515827483896875618958121606201292619775n,

        zZoneMaximumAmountPerTimePeriod: 1 * 10 ** 13,
        zZoneTimePeriodPerMaximumAmount: 86400,
        zZoneSealing: 1,

        zZoneDataEscrowEncryptedMessage: [
            21022076763366182175477357918933442131485472229146225036655452082762082124322n,
        ],
        zZoneDataEscrowEncryptedMessageHmac:
            14496019412495389807807919111786846616937183677820347136868875172131919005507n,

        kytEdDsaPubKey: [
            13277427435165878497778222415993513565335242147425444199013288855685581939618n,
            13622229784656158136036771217484571176836296686641868549125388198837476602820n,
        ],
        kytEdDsaPubKeyExpiryTime: 1735689600,
        trustProvidersMerkleRoot:
            675413191976636849763056983375622181122390331630387511499559599588194530856n,

        kytPathElements: [
            9489899717616586094160199124420951802253527995585848778940667248421979517388n,
            15915358021544645824948763611506574620607002248967455613245207713011512736724n,
            3378776220260879286502089033253596247983977280165117209776494090180287943112n,
            13332607562825133358947880930907706925768730553195841232963500270946125500492n,
            2602133270707827583410190225239044634523625207877234879733211246465561970688n,
            19603150025355661252212198237607440386334054455687766589389473805115541553727n,
            21078238521337523625806977154031988767929399923323679789427062985634312723305n,
            15530836891415741166399860451702547522959094984965127719828675838122418186767n,
            17831836427614557290431652044145414371925087626131808598362009890774438652119n,
            4465836784202878977538296341471470300441964855135851519008900812038788261656n,
            12878033372712703816810492505815415858124057351499708737135229819203122809944n,
            18307780612008914306024415546812737365063691384665843671053755584619447524447n,
            18399220794236723308907532455368503933105202479015828179801520916772962880998n,
            17997772780903759195601581429183819619412163062353143936165307874482723961709n,
            18496693394049906980893311686550786982256672525298758106045562727433199943509n,
            12455859713696229724526221339047857485467607588813434501517928769317308134556n,
        ],
        kytPathIndices: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        kytMerkleTreeLeafIDsAndRulesOffset: 1,

        kytDepositSignedMessagePackageType: 2,
        kytDepositSignedMessageTimestamp: 1700040650,
        kytDepositSignedMessageSender:
            407487970930055136132864974074225519407787604125n,
        kytDepositSignedMessageReceiver:
            0xfdfd920f2152565e9d7b589e4e9faee6699ad4bdn,
        kytDepositSignedMessageToken:
            365481738974395054943628650313028055219811856521n,
        kytDepositSignedMessageSessionId: 3906,
        kytDepositSignedMessageRuleId: 94,
        kytDepositSignedMessageAmount: 10 ** 13,
        kytDepositSignedMessageChargedAmountZkp: 0, // check for a non - zero value
        kytDepositSignedMessageSigner:
            407487970930055136132864974074225519407787604125n,
        kytDepositSignedMessageHash:
            10423494343006799813370996707236493762718882344186851738760354027050895770547n,

        kytDepositSignature: [
            289458614423130873546006790728948359058809006695210921445230119397470500492n,
            143164985595862467910878192043505987425723304380527310972509234107092651167n,
            20845142422496963901478555469221071616674097321612537654153624746373740325087n,
        ],

        kytWithdrawSignedMessagePackageType: 2,
        kytWithdrawSignedMessageTimestamp: 0,
        kytWithdrawSignedMessageSender: 0,
        kytWithdrawSignedMessageReceiver: 0,
        kytWithdrawSignedMessageToken: 0,
        kytWithdrawSignedMessageSessionId: 0,
        kytWithdrawSignedMessageRuleId: 0,
        kytWithdrawSignedMessageAmount: 0,
        kytWithdrawSignedMessageChargedAmountZkp: 0,
        kytWithdrawSignedMessageSigner: 0,
        kytWithdrawSignedMessageHash: 0,
        kytWithdrawSignature: [0, 0, 0],

        kytSignedMessagePackageType: 253,
        kytSignedMessageTimestamp: 1735689600,
        kytSignedMessageSessionId: 0,
        kytSignedMessageChargedAmountZkp: 0,
        kytSignedMessageSigner:
            407487970930055136132864974074225519407787604125n,
        kytSignedMessageDataEscrowHash: 0,
        kytSignedMessageHash:
            6099429931396121996657066805913447529635090159324513955306339471985599147963n,
        kytSignature: [
            2305533273584353825739435722420744759947022991637956155259409042540895942602n,
            7248046211883189204026564017222357952032425034486643207391252095407290468285n,
            8732982225844251514845234508320910044066797888045792804410516501305721796165n,
        ],

        dataEscrowPubKey: [
            6461944716578528228684977568060282675957977975225218900939908264185798821478n,
            6315516704806822012759516718356378665240592543978605015143731597167737293922n,
        ],
        dataEscrowPubKeyExpiryTime: 1735689600,
        dataEscrowEphemeralRandom:
            2508770261742365048726528579942226801565607871885423400214068953869627805520n,

        dataEscrowEphemeralPubKeyAx:
            4301916310975298895721162797900971043392040643140207582177965168853046592976n,

        dataEscrowEphemeralPubKeyAy:
            815388028464849479935447593762613752978886104243152067307597626016673798528n,

        dataEscrowPathElements: [
            691692403787570541002677048455170081661625713855976896409615085264963003363n,
            15915358021544645824948763611506574620607002248967455613245207713011512736724n,
            3378776220260879286502089033253596247983977280165117209776494090180287943112n,
            13332607562825133358947880930907706925768730553195841232963500270946125500492n,
            2602133270707827583410190225239044634523625207877234879733211246465561970688n,
            19603150025355661252212198237607440386334054455687766589389473805115541553727n,
            21078238521337523625806977154031988767929399923323679789427062985634312723305n,
            15530836891415741166399860451702547522959094984965127719828675838122418186767n,
            17831836427614557290431652044145414371925087626131808598362009890774438652119n,
            4465836784202878977538296341471470300441964855135851519008900812038788261656n,
            12878033372712703816810492505815415858124057351499708737135229819203122809944n,
            18307780612008914306024415546812737365063691384665843671053755584619447524447n,
            18399220794236723308907532455368503933105202479015828179801520916772962880998n,
            17997772780903759195601581429183819619412163062353143936165307874482723961709n,
            18496693394049906980893311686550786982256672525298758106045562727433199943509n,
            12455859713696229724526221339047857485467607588813434501517928769317308134556n,
        ],
        dataEscrowPathIndices: [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],

        dataEscrowEncryptedMessage: [
            13973906648626983182034480328119298803693100268701353088057843846936256349042n,
            473107879088864817427941367142854458250433871003316364107425192816097535880n,
            5494747578719849743514538994145141818891361484689613558464885736461065634004n,
            17478869179407600441624504783451962827747408866666665035038148654122072068560n,
            3979705822755801962959100881652950811750399282785018064249634205385110664507n,
        ],
        dataEscrowEncryptedMessageHmac:
            20308413222235747204739468029642433576984452582662013231195024223970541218668n,
        daoDataEscrowPubKey: [
            6744227429794550577826885407270460271570870592820358232166093139017217680114n,
            12531080428555376703723008094946927789381711849570844145043392510154357220479n,
        ],
        daoDataEscrowEphemeralRandom:
            2486295975768183987242341265649589729082265459252889119245150374183802141273n,

        daoDataEscrowEphemeralPubKeyAx:
            18172727478723733672122242648004425580927771110712257632781054272274332874233n,

        daoDataEscrowEphemeralPubKeyAy:
            18696859439217809465524370245449396885627295546811556940609392448191776076084n,

        daoDataEscrowEncryptedMessage: [
            3231509157406275324672292283075363620846365487114545308584982449118638448232n,
        ],
        daoDataEscrowEncryptedMessageHmac:
            8081035620019166524915505925588464047085389491348593371364462372175687710253n,

        // Same timestamp is used for ZAccountUTXOOut as well.
        utxoOutCreateTime: 1700020032, //  utxoOutCreateTime - Wednesday, 15 November 2023 03:47:12
        utxoOutOriginNetworkId: [2, 0],
        utxoOutTargetNetworkId: [2, 0],
        utxoOutTargetZoneId: [1, 0],
        utxoOutTargetZoneIdOffset: [0, 0],
        utxoOutSpendPubKeyRandom: [
            94610875299416841087047638331595192377823041951625049650587645487287023247n,
            0,
        ],
        utxoOutRootSpendPubKey: [
            [
                9665449196631685092819410614052131494364846416353502155560380686439149087040n,
                13931233598534410991314026888239110837992015348186918500560502831191846288865n,
            ],
            [0, 1],
        ],
        utxoOutCommitment: [
            9291804555659638868032806916727196008325111045486834260708554199567090850299n,
            0,
        ],

        zAccountUtxoOutSpendKeyRandom:
            1215795509656177802870041674430711702496004716229829094660171184836034819583n,

        zAccountUtxoOutCommitment:
            252201640316781803990098408451884564126495501953986423034221778417602805405n,

        zNetworkChainId: 80001,
        zNetworkIDsBitMap: 5,
        zNetworkTreeMerkleRoot:
            21448888980709764146265348599357914296432058767851940011937843763756766907579n,
        zNetworkTreePathIndices: [1, 0, 0, 0, 0, 0],
        zNetworkTreePathElements: [
            17570133518121739548964196309665064125657253468811303682702000180123719703330n,
            15915358021544645824948763611506574620607002248967455613245207713011512736724n,
            3378776220260879286502089033253596247983977280165117209776494090180287943112n,
            13332607562825133358947880930907706925768730553195841232963500270946125500492n,
            2602133270707827583410190225239044634523625207877234879733211246465561970688n,
            19603150025355661252212198237607440386334054455687766589389473805115541553727n,
        ],
        staticTreeMerkleRoot:
            15348222720660628311446592885548915884577953917057577776988845594265385226543n,

        forestMerkleRoot: 0,
        taxiMerkleRoot:
            21078238521337523625806977154031988767929399923323679789427062985634312723305n,

        busMerkleRoot:
            19439449537123993489142290333566964052131663851453131313859155542237608100615n,

        ferryMerkleRoot:
            16585547643065588372010718035675163508420403417446192422307560350739915741648n,

        salt: 0,
        saltHash: 0,

        magicalConstraint: 0,
    };

    it('should compute valid witness for zero input deposit only tx', async () => {
        await wtns.calculate(nonZeroInput, mainTxWasm, mainTxWitness, null);
        console.log('Witness calculation successful!');
    });
});
